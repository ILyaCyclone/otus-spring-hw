<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Library</title>
</head>
<body>
<header th:replace="fragments/header :: header (headerText=${bookDto.id == null ? 'Create book' : 'Book'})">
    <h1>App Name</h1>

    Navigation goes here

    <h2>Page Title</h2>
</header>

<div th:replace="fragments/message :: message (headerText=${message})">Message text</div>

<form th:action="@{/books/save}" method="post" th:object="${bookDto}">
    <input type="hidden" name="id" th:value="*{id}">

    <label>Title:
        <input type="text" required name="title" th:value="*{title}">
    </label>

    <label>Year:
        <input type="text" required name="year" th:value="*{year}">
    </label>

    <label>Author:
        <select name="authorId" required>
            <option th:each="authorOption : ${allAuthors}" th:value="${authorOption.id}"
                    th:text="${authorOption.firstname} + ' ' + ${authorOption.lastname}"
                    th:selected="${authorOption.id == bookDto.authorId}"></option>
        </select>
    </label>

    <label>Genre:
        <select name="genreId" required>
            <option th:each="genreOption : ${allGenres}" th:object="${genreOption}" th:value="*{id}" th:text="*{name}"
                    th:selected="${genreOption.id == bookDto.genreId}"></option>
        </select>
    </label>

    <input type="submit" value="Submit">
</form>

<section th:if="${bookDto.id != null}">
    <form th:action="@{/books/{id}/delete(id=${bookDto.id})}" method="post">
        <input type="submit" value="Delete">
    </form>
</section>

<section class="comments" th:if="${bookDto.id != null}">
    <ul>
        <li th:each="comment : ${comments}" th:object="${comment}">
            <span th:text="*{commentator}">Commentator</span>:
            <span th:text="*{text}">Comment text</span>
        </li>
    </ul>


    <form th:action="@{/books/{id}/comments/save(id=${bookDto.id})}" method="post">
        <p2>Leave a comment:</p2>
        <input type="text" name="commentator" required placeholder="Your name...">

        <textarea name="text" required placeholder="Type a comment..."></textarea>

        <input type="submit" value="Submit">
    </form>


</section>


</body>
</html>